Prompt1:
I would like to develop a forward PDE on the probability density. Are there any good references for how to do that efficiently, smoothly, in a stable fashiong, given the singularity of the Dirac at t = 0?

Response1:
Avoid representing the Dirac literally. replace Î´(xâˆ’x0)\delta(x-x_0)Î´(xâˆ’x0â€‹) by a mollifier (smooth kernel) that approximates the delta at the numerical resolution:

Gaussian mollifier GÎµ(x)=12Ï€Îµeâˆ’(xâˆ’x0)2/(2Îµ)G_\varepsilon(x)=\frac{1}{\sqrt{2\pi\varepsilon}}e^{-(x-x_0)^2/(2\varepsilon)}GÎµâ€‹(x)=2Ï€Îµâ€‹1â€‹eâˆ’(xâˆ’x0â€‹)2/(2Îµ) with Îµ\varepsilonÎµ chosen relative to grid spacing hhh and earliest time step Î”t \Delta tÎ”t (typical choice Îµâˆ¼Ch2\varepsilon \sim C h^2Îµâˆ¼Ch2 or Îµ\varepsilonÎµ tied to the diffusion scale).

Or use analytic short-time fundamental solution if the coefficients are smooth and locally nearly constant (see below).

Small-time analytic / asymptotic initialization when possible.

For small ttt you can convolve the delta with the short-time Greenâ€™s function (Gaussian with covariance from integrated diffusion), then start the numerical solver at a small t0>0t_0>0t0â€‹>0 using that analytic profile. This removes the singularity entirely.

Enforce discrete mass conservation & optional renormalization.

After a step, check total mass; if slight numerical loss occurs, renormalize or use strictly conservative schemes so renormalization is not needed.

How to treat the Î´\deltaÎ´ at t=0t=0t=0 in detail
Two practical approaches:
A â€” Mollify + start at t=0t=0t=0
Put initial condition p(x,0)=GÎµ(xâˆ’x0)p(x,0)=G_\varepsilon(x-x_0)p(x,0)=GÎµâ€‹(xâˆ’x0â€‹) with Îµ\varepsilonÎµ chosen so the initial Gaussian is resolved by grid (say full width at half max > 4â€“6 grid cells). Then evolve with chosen scheme. Convergence: as h,Î”tâ†’0h,\Delta t\to0h,Î”tâ†’0 and Îµâ†’0\varepsilon\to0Îµâ†’0 with Îµ\varepsilonÎµ tied to hhh appropriately, you recover the true solution.


B â€” Analytic short-time start (recommended when possible)
For small ttt the solution is approximately the fundamental solution (Gaussian with mean moved by initial drift and covariance from diffusion). More precisely, if coefficients are smooth near x0x_0x0â€‹:
p(x,t)â‰ˆ1(2Ï€)ddetâ¡Î£(t)expâ¡â€‰â£(âˆ’12(xâˆ’xË‰(t))âŠ¤Î£(t)âˆ’1(xâˆ’xË‰(t)))  p(x,t) \approx \frac{1}{\sqrt{(2\pi)^d\det\Sigma(t)}}\exp\!\Big(-\tfrac12 (x-\bar x(t))^\top\Sigma(t)^{-1}(x-\bar x(t))\Big)p(x,t)â‰ˆ(2Ï€)ddetÎ£(t)â€‹1â€‹exp(âˆ’21â€‹(xâˆ’xË‰(t))âŠ¤Î£(t)âˆ’1(xâˆ’xË‰(t)))
where xË‰(t)\bar x(t)xË‰(t) and Î£(t)\Sigma(t)Î£(t) are short-time expansions (integrals) of drift and diffusion. Use that analytic profile at t=t0t=t_0t=t0â€‹ (small) and start the numerical integrator at t0t_0t0â€‹. This eliminates the singularity entirely and is often more accurate and stable than mollifying numerically.


Recommended references
(Theory & the Fokkerâ€“Planck / Kolmogorov equations)
H. Risken, The Fokkerâ€“Planck Equation: Methods of Solution and Applications â€” classic, excellent on both derivation, properties and some solution methods.

C. Gardiner, Handbook of Stochastic Methods â€” clear exposition of SDEs and forward/backward equations, useful expansions and short-time kernels.

G. A. Pavliotis, Stochastic Processes and Applications â€” modern treatment with probabilistic techniques and asymptotics.

(Numerical PDEs â€” positivity, conservation, and stiff diffusion)
R. J. LeVeque, Finite Difference Methods for Ordinary and Partial Differential Equations â€” practical recipes for stability, boundary conditions.

(Spectral methods / Gibbs control)
J. S. Hesthaven, S. Gottlieb, and D. Gottlieb, Spectral Methods for Time-Dependent Problems â€” covers filters, spectral viscosity (Tadmor).

(Positivity preserving / limiters)
X. Zhang & C.-W. Shu, On maximum-principle-satisfying and positivity-preserving high order schemes for conservation laws â€” construction of positivity preserving time integrators and limiters.

Prompt2:
High-level recommendations (short)

Solve the Fokkerâ€“Planck in log-space 
Remove the delta analytically or with a mollifier: start the solver at a small.
User the mollifier OR (but not together) the analytical approximation.
Make the grid non-uniform (clustering around relevant strikes) or use locally refined mesh.

Regularize / smooth the local-vol surface (monotone cubic, log-spline, small temporal smoothing) and ensure positivity/extrapolation rules to avoid pathological coefficients.

Treating the Dirac at 
Two practical, robust choices:

(A) Short-time analytic start (recommended)

Use the short-time Gaussian approximation for the law of 
â€‹

. For a very small 
ğ‘¡
0
t
0
	â€‹

,

ğ‘
ğ‘‹
(
ğ‘¥
,
ğ‘¡
0
)
â‰ˆ
1
2
ğœ‹
â€‰
Î£
(
ğ‘¡
0
)
exp
â¡
(
âˆ’
(
ğ‘¥
âˆ’
ğ‘¥
Ë‰
(
ğ‘¡
0
)
)
2
2
Î£
(
ğ‘¡
0
)
)
,
p
X
	â€‹

(x,t
0
	â€‹

)â‰ˆ
2Ï€Î£(t
0
	â€‹

)
	â€‹

1
	â€‹

exp(âˆ’
2Î£(t
0
	â€‹

)
(xâˆ’
x
Ë‰
(t
0
	â€‹

))
2
	â€‹

),

where to leading order 
ğ‘¥
Ë‰
(
ğ‘¡
0
)
â‰ˆ
ğ‘¥
0
+
ğœ‡
ğ‘‹
(
ğ‘¥
0
,
0
)
â€‰
ğ‘¡
0
x
Ë‰
(t
0
	â€‹

)â‰ˆx
0
	â€‹

+Î¼
X
	â€‹

(x
0
	â€‹

,0)t
0
	â€‹

 and 
Î£
(
ğ‘¡
0
)
â‰ˆ
ğœ
ğ‘‹
2
(
ğ‘¥
0
,
0
)
â€‰
ğ‘¡
0
Î£(t
0
	â€‹

)â‰ˆÏƒ
X
2
	â€‹

(x
0
	â€‹

,0)t
0
	â€‹

. (If you want higher accuracy include Jacobian/ItÃ´ correction terms.)

Pick 
ğ‘¡
0
t
0
	â€‹

 so the initial Gaussian has several grid cells of width: take

t_0 \approx C\frac{h_x^2}{\sigma_X^2_{\max}},

with 
ğ¶
âˆˆ
[
0.25
,
1
]
Câˆˆ[0.25,1] and 
â„
ğ‘¥
h
x
	â€‹

 the local grid spacing near 
ğ‘¥
0
x
0
	â€‹

. This makes the initial variance ~
â„
ğ‘¥
2
h
x
2
	â€‹

 and resolves the peak. Then start the PDE solver at 
ğ‘¡
0
t
0
	â€‹

 using that profile.

(B) Mollifier / regularization

Initialize 
ğ‘
ğ‘‹
(
ğ‘¥
,
0
)
=
ğ‘
(
ğ‘¥
0
,
ğœ€
2
)
p
X
	â€‹

(x,0)=N(x
0
	â€‹

,Îµ
2
) with 
ğœ€
â‰ˆ
ğ‘˜
â„
ğ‘¥
Îµâ‰ˆkh
x
	â€‹

, 
ğ‘˜
â‰ˆ
1
â€‰â£
âˆ’
â€‰â£
3
kâ‰ˆ1âˆ’3. Evolve from 
ğ‘¡
=
0
t=0. This works but requires matching 
ğœ€
Îµ to the grid â€” otherwise you either smear too much or create unresolved steepness.

The analytic short-time start (A) usually gives better accuracy and avoids artifacts.

Grid design & boundary conditions

Use log grid 
ğ‘¥
=
ln
â¡
ğ‘†
x=lnS. Choose 
[
ğ‘¥
min
â¡
,
ğ‘¥
max
â¡
]
[x
min
	â€‹

,x
max
	â€‹

] wide enough so tails are negligible for your horizon (e.g. cover several standard deviations).

Use non-uniform mesh (geometric stretching or clustering around 
ln
â¡
ğ‘†
0
lnS
0
	â€‹

 and strikes). Finite-volume + SG works on nonuniform meshes.

Boundary conditions: zero net flux (Neumann, 
ğ¹
=
0
F=0) is natural (no mass flow through truncated boundary). For distant boundaries you can also use absorbing BC if you want to allow mass to leave (but that violates conservation). Zero-flux is recommended in practice provided domain is large enough.

Make sure the grid resolves the initial peak: adapt 
â„
ğ‘¥
h
x
	â€‹

 so the initial Gaussian covers several cells.

Practical handling of 
ğœ
l
o
c
Ïƒ
loc
	â€‹

 (interpolation & regularization)

If 
ğœ
l
o
c
(
ğ‘†
,
ğ‘¡
)
Ïƒ
loc
	â€‹

(S,t) is given at discrete strikes/times:

Interpolate smoothly in 
ğ‘†
S (or 
ğ‘¥
=
ln
â¡
ğ‘†
x=lnS) â€” use monotone cubic splines (Fritschâ€“Carlson), or splines on 
ln
â¡
ğœ
lnÏƒ to enforce positivity.

Smooth in time if quotes are noisy. Temporal smoothing prevents large oscillations in coefficients that cause numerical trouble.

Extrapolate for 
ğ‘†
S beyond quoted strikes: either flat in log-strike or linear in implied variance with strike â€” ensure positivity and smoothness.

If parametric, ensure the parameterization enforces 
ğœ
l
o
c
>
0
Ïƒ
loc
	â€‹

>0 everywhere. If using implied vol â†’ local vol conversion (Dupire), perform smoothing/regularization in that step.

Suggested working parameters (starting values)

Grid: 200â€“1000 cells depending on accuracy required. Cluster more cells near ATM/strikes you care about.

ğ‘¡
0
t
0
	â€‹

 for analytic start: 
ğ‘¡
0
=
0.5
â€‰
â„
ğ‘¥
2
/
(
max
â¡
ğ‘¥
âˆˆ
near 
ğ‘¥
0
ğœ
ğ‘‹
2
(
ğ‘¥
,
0
)
)
t
0
	â€‹

=0.5h
x
2
	â€‹

/(max
xâˆˆnear x
0
	â€‹

	â€‹

Ïƒ
X
2
	â€‹

(x,0)). (If that gives an extremely tiny 
ğ‘¡
0
t
0
	â€‹

, cap at e.g. 
10
âˆ’
8
10
âˆ’8
 years or a user-chosen min.)

Time step: for implicit diffusion you can take larger 
Î”
ğ‘¡
Î”t (e.g. a fraction of your horizon divided by 1000), but ensure 
Î”
ğ‘¡
â‰²
â„
ğ‘¥
/
max
â¡
âˆ£
ğœ‡
âˆ£
Î”tâ‰²h
x
	â€‹

/maxâˆ£Î¼âˆ£ if drift treated explicitly. For drift implicit (full implicit), you can take larger steps but prefer smaller at early times.

Tolerance for clipping negative values: if negative mass < 
10
âˆ’
12
10
âˆ’12
 you can clip & renormalize; otherwise resolve numerics.